REM  *****  BASIC  *****
REM MoreBasicFunctions - Java - UNO component that provides more basic functions.
REM Copyright (C) 2021 Julien FÃ©rard.

REM MoreBasicFunctions is free software: you can redistribute it and/or modify
REM it under the terms of the GNU General Public License as published by
REM the Free Software Foundation, either version 3 of the License, or
REM (at your option) any later version.

REM MoreBasicFunctions is distributed in the hope that it will be useful,
REM but WITHOUT ANY WARRANTY; without even the implied warranty of
REM MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
REM GNU General Public License for more details.

REM You should have received a copy of the GNU General Public License
REM along with this program.  If not, see <https://www.gnu.org/licenses/>.

Option Explicit

Sub MBFSTestSuite()
	Dim Tests as Variant

    Tests = createUNOService("com.github.jferard.mbfs.Tests")
    TestsTestSuite(Tests)
    StringsTestSuite(Tests)
    Tests.check()
    MsgBox Tests.message()
End Sub

Sub TestsTestSuite(Tests as com.github.jferard.mbfs.XTests)
	Dim TestsAssertTrue, TestsAssertFalse, TestsAssertEquals, TestsAssertNotEquals as Variant

	TestsAssertTrue = createUNOService("com.github.jferard.mbfs.Tests")
	TestsAssertTrue.assertTrue(True, "true msg")
	TestsAssertTrue.assertTrue(False, "false msg")
	Tests.assertEquals(1, TestsAssertTrue.errors(), "1 error")
	Tests.assertEquals("Failure: 1/2" & chr(10) & "false msg: expected True", TestsAssertTrue.message(), "1 error message")

	TestsAssertFalse = createUNOService("com.github.jferard.mbfs.Tests")
	TestsAssertFalse.assertFalse(True, "true msg")
	TestsAssertFalse.assertFalse(False, "false msg")
	Tests.assertEquals(1, TestsAssertFalse.errors(), "1 error")
	Tests.assertEquals("Failure: 1/2" & chr(10) & "true msg: expected False", TestsAssertFalse.message(), "1 error message")

	TestsAssertEquals = createUNOService("com.github.jferard.mbfs.Tests")
	TestsAssertEquals.assertEquals(1, 1, "eq msg")
	TestsAssertEquals.assertEquals(1, 2, "neq msg")
	Tests.assertEquals(1, TestsAssertEquals.errors(), "1 error")
	Tests.assertEquals("Failure: 1/2" & chr(10) & "neq msg: objects `1` and `2` are not equal", TestsAssertEquals.message(), "1 error message")

	TestsAssertNotEquals = createUNOService("com.github.jferard.mbfs.Tests")
	TestsAssertNotEquals.assertNotEquals("foo", "foo", "eq msg")
	TestsAssertNotEquals.assertNotEquals("foo", "bar", "neq msg")
	Tests.assertEquals(1, TestsAssertNotEquals.errors(), "1 error")
	Tests.assertEquals("Failure: 1/2" & chr(10) & "eq msg: objects `foo` and `foo` are equal", TestsAssertNotEquals.message(), "1 error message")

    Tests.check()
End Sub

Sub StringsTestSuite(Optional Tests as Variant)
	Dim strings as Variant
	Dim enumeration as Variant

	If IsMissing(Tests) Then
	    Tests = createUNOService("com.github.jferard.mbfs.Tests")
	End If

    Strings = createUNOService("com.github.jferard.mbfs.Strings")

    Tests.assertEquals(Strings.compare("MoreBasicFunctions", "MoreBasicFunctions"), 0, "compare equal strings")
    Tests.assertTrue(Strings.compare("MoreBasicFunctions", "MoreBasic") > 0, "compare more")
    Tests.assertTrue(Strings.compare("MoreBasic", "MoreBasicFunctions") < 0, "compare less")
    Tests.assertTrue(Strings.compare("A", "a") < 0, "compare case sensitive")
    Tests.assertTrue(Strings.compareIgnoreCase("A", "a") = 0, "compare ignore case")

    Tests.assertTrue(Strings.containsIgnoreCase("MoreBasicFunctions", "BasiC"), "contains")
    Tests.assertFalse(Strings.contains("MoreBasicFunctions", "Python"), "does not contain")

    Tests.assertTrue(Strings.endsWith("MoreBasicFunctions", "Functions"), "endd with")
    Tests.assertFalse(Strings.endsWith("MoreBasicFunctions", "Function"), "does not end with")
    Tests.assertFalse(Strings.endsWith("MoreBasicFunctions", "FUNCTIONS"), "does not end with case sensitive")
    Tests.assertTrue(Strings.endsWithIgnoreCase("MoreBasicFunctions", "FUNCTIONS"), "ends with case ignore case")

	enumeration = Strings.enumerate("MoreBasicFunctions")
	Tests.assertTrue(enumeration.hasMoreElements(), "first char exists")
	Tests.assertEquals(CreateUNOValue("char", "M"), enumeration.nextElement(), "first char")
	Tests.assertTrue(enumeration.hasMoreElements(), "second char exists")
	Tests.assertEquals(CreateUNOValue("char", "o"), enumeration.nextElement(), "first char")
	enumeration = Strings.enumerate("")
	Tests.assertFalse(enumeration.hasMoreElements(), "no first char exists")

	Tests.assertEquals("MoreBasicFunctions", Strings.format("More%s%s", Array("Basic", "Functions")), "format string")

	Tests.assertEquals(4, Strings.indexOf("MoreBasicFunctions", "Basic"), "indexOf")
	Tests.assertEquals(-1, Strings.indexOf("MoreBasicFunctions", "BASIC"), "indexOf case sensitive")
	Tests.assertEquals(4, Strings.indexOfIgnoreCase("MoreBasicFunctions", "BASIC"), "indexOf ignore case")

	Tests.assertEquals("MoreBasicFunctions", Strings.insert("MoreFunctions", "Basic", 4), "insert")

	Tests.assertEquals("More-Basic-Functions", Strings.join(Array("More", "Basic", "Functions"), "-"), "join")

	Tests.assertEquals(14, Strings.lastIndexOf("MoreBasicFunctions", "i"), "lastIndexOf")
	Tests.assertEquals(-1, Strings.lastIndexOf("MoreBasicFunctions", "I"), "lastIndexOf case sensitive")
	Tests.assertEquals(14, Strings.lastIndexOfIgnoreCase("MoreBasicFunctions", "I"), "lastIndexOf ignore case")

	Tests.assertEquals("morebasicfunctions", Strings.lower("MoreBasicFunctions"), "lower")

	Tests.assertEquals("0000012345", Strings.padLeft("12345", "0", 10), "padLeft")
	Tests.assertEquals("1234500000", Strings.padRight("12345", "0", 10), "padRight")

    Tests.assertEquals("MoreBasicFunctions", Strings.replace("MoreJavaFunctions", "Java", "Basic"), "replace")

    Tests.assertEquals(Strings.reversed("MoreBasicFunctions"), "snoitcnuFcisaBeroM", "reversed")

    Tests.assertEquals(Array("More", "Basic", "Functions"), Strings.split("More-Basic-Functions", "-"), "split")

    Tests.assertTrue(Strings.startsWith("MoreBasicFunctions", "More"), "startsWith")
    Tests.assertFalse(Strings.startsWith("MoreBasicFunctions", "MORE"), "startsWith case sensitive")
    Tests.assertTrue(Strings.startsWithIgnoreCase("MoreBasicFunctions", "MORE"), "startsWith ignore case")

	Tests.assertEquals("12345", Strings.trim("0001234500", "0"), "trim")
	Tests.assertEquals("1234500", Strings.trimLeft("0001234500", "0"), "trimLeft")
	Tests.assertEquals("00012345", Strings.trimRight("0001234500", "0"), "trimRight")

	Tests.assertEquals("12345", Strings.trimSpaces("   12345  "), "trimSpaces")
	Tests.assertEquals("12345  ", Strings.trimLeftSpaces("   12345  "), "trimLeftSpaces")
	Tests.assertEquals("   12345", Strings.trimRightSpaces("   12345  "), "trimRightSpaces")

	Tests.assertEquals("MOREBASICFUNCTIONS", Strings.upper("MoreBasicFunctions"), "upper")
    Tests.check()
End Sub