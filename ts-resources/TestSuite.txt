REM  *****  BASIC  *****
REM MoreBasicFunctions - Java - UNO component that provides more basic functions.
REM Copyright (C) 2021 Julien FÃ©rard.

REM MoreBasicFunctions is free software: you can redistribute it and/or modify
REM it under the terms of the GNU General Public License as published by
REM the Free Software Foundation, either version 3 of the License, or
REM (at your option) any later version.

REM MoreBasicFunctions is distributed in the hope that it will be useful,
REM but WITHOUT ANY WARRANTY; without even the implied warranty of
REM MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
REM GNU General Public License for more details.

REM You should have received a copy of the GNU General Public License
REM along with this program.  If not, see <https://www.gnu.org/licenses/>.

Option Explicit

Sub MBFSTestSuite()
	Dim Tests as Variant

    Tests = createUNOService("com.github.jferard.mbfs.Tests")
    TestsTestSuite(Tests)
    StringsTestSuite(Tests)
    Tests.check()
    MsgBox Tests.message()
End Sub

Sub TestsTestSuite(Tests as com.github.jferard.mbfs.XTests)
	Dim TestsAssertTrue, TestsAssertFalse, TestsAssertEquals, TestsAssertNotEquals as Variant

	TestsAssertTrue = createUNOService("com.github.jferard.mbfs.Tests")
	TestsAssertTrue.assertTrue(True, "true msg")
	TestsAssertTrue.assertTrue(False, "false msg")
	Tests.assertEquals(1, TestsAssertTrue.errors(), "1 error")
	Tests.assertEquals("Failure: 1/2" & chr(10) & "false msg: expected True", TestsAssertTrue.message(), "1 error message")

	TestsAssertFalse = createUNOService("com.github.jferard.mbfs.Tests")
	TestsAssertFalse.assertFalse(True, "true msg")
	TestsAssertFalse.assertFalse(False, "false msg")
	Tests.assertEquals(1, TestsAssertFalse.errors(), "1 error")
	Tests.assertEquals("Failure: 1/2" & chr(10) & "true msg: expected False", TestsAssertFalse.message(), "1 error message")

	TestsAssertEquals = createUNOService("com.github.jferard.mbfs.Tests")
	TestsAssertEquals.assertEquals(1, 1, "eq msg")
	TestsAssertEquals.assertEquals(1, 2, "neq msg")
	Tests.assertEquals(1, TestsAssertEquals.errors(), "1 error")
	Tests.assertEquals("Failure: 1/2" & chr(10) & "neq msg: objects `1` and `2` are not equal", TestsAssertEquals.message(), "1 error message")

	TestsAssertNotEquals = createUNOService("com.github.jferard.mbfs.Tests")
	TestsAssertNotEquals.assertNotEquals("foo", "foo", "eq msg")
	TestsAssertNotEquals.assertNotEquals("foo", "bar", "neq msg")
	Tests.assertEquals(1, TestsAssertNotEquals.errors(), "1 error")
	Tests.assertEquals("Failure: 1/2" & chr(10) & "eq msg: objects `foo` and `foo` are equal", TestsAssertNotEquals.message(), "1 error message")

    Tests.check()
End Sub

Sub StringsTestSuite(Tests as com.github.jferard.mbfs.XTests)
	Dim strings as Variant

    Strings = createUNOService("com.github.jferard.mbfs.Strings")
    Tests.assertEquals(Strings.reversed("MoreBasicFunctions"), "snoitcnuFcisaBeroM", "reversed")
    Tests.assertTrue(Strings.containsIgnoreCase("MoreBasicFunctions", "BasiC"), "contains")
    Tests.check()
End Sub